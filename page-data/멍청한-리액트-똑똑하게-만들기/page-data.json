{"componentChunkName":"component---src-templates-post-jsx","path":"/멍청한-리액트-똑똑하게-만들기","result":{"data":{"markdownRemark":{"id":"1117bc0f-1593-5c22-9d4a-1558a0828213","html":"<h2 id=\"리액트가-똑똑한-줄-알았지만-착각이었다\" style=\"position:relative;\"><a href=\"#%EB%A6%AC%EC%95%A1%ED%8A%B8%EA%B0%80-%EB%98%91%EB%98%91%ED%95%9C-%EC%A4%84-%EC%95%8C%EC%95%98%EC%A7%80%EB%A7%8C-%EC%B0%A9%EA%B0%81%EC%9D%B4%EC%97%88%EB%8B%A4\" aria-label=\"리액트가 똑똑한 줄 알았지만 착각이었다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>리액트가 똑똑한 줄 알았지만, 착각이었다</h2>\n<p>회사에서 만드는 웹 앱에 엄청나게 큰 컴포넌트 트리가 있었다.\n그리고는 뭔가를 발견했는데... 바로 위에서부터 아래 깊숙히까지 렌더링이 되고 있는 컴포넌트들이었다!\n처음엔 렌더링을 방지하는 것이 마냥 쉬운 줄만 알고 있었다.</p>\n<p><span\n      class=\"gatsby-resp-image-wrapper\"\n      style=\"position: relative; display: block; margin-left: auto; margin-right: auto;  max-width: 690px;\"\n    >\n      <a\n    class=\"gatsby-resp-image-link\"\n    href=\"/static/dea2f1bf42c8d14cec7363bbd8d5fdd9/ad997/react-flame-chart.png\"\n    style=\"display: block\"\n    target=\"_blank\"\n    rel=\"noopener\"\n  >\n    <span\n    class=\"gatsby-resp-image-background-image\"\n    style=\"padding-bottom: 47.82608695652174%; position: relative; bottom: 0; left: 0; background-image: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABQAAAAKCAYAAAC0VX7mAAAACXBIWXMAAAsSAAALEgHS3X78AAAB3klEQVQoz62QPW/TUBSGLeCvsfAX8AADC0gsjAxMReFDYWi6IAYnZGmn8hEaRJRWtIEmDnXsxElTApGJAo2/rx3bpb4+h2snLcyor/To+NrnPD42J757ca0ubt2QDyReliW+00k54BWlw7fEJl+tVfn6Tp1//6HKi+023+v1+K6isNplPTKbka+zelOSpKtcmqNhf2TPA/ylm+jP5xhFUUYYhkg8gp7voeVYaNomhpGHvk+QsHsuITgPAnb2MI2maVImPBx+7esmQdO0Y8u0qWMtsBn6TKemYVHtx5gOxyM6mU2pMxnTn+0mPZbaNDR0GlN6mgoNw2gy3RWutpkbiG/u49FejvZ3V0DdzYHayIO6/RC+fX4Ch58ewUh5CYE9hegkZtUCTVXAm04gdh1gLpoKXddtMeFlrvBWGNxef4oPtp4nwt46bkg13P/yCh+v3cK10l3c3C6gGxE8C00S/B3H52cAyISO44jZho3vo0F1dowN3UwmwQmErKc71WB15zV8HDTBIFa6BSTwNwvPec6ErUw493x1+TL2L9hD1kABKV18Cl0sldB0MOXf6yWnS+F+JvR8X8MLCCGkmwmLxeK9crm8WiqV8oxn/0GezRcEQbiTCZe5dAFwlUqF+wOZbVJUsAEppAAAAABJRU5ErkJggg=='); background-size: cover; display: block;\"\n  ></span>\n  <img\n        class=\"gatsby-resp-image-image\"\n        alt=\"react flame chart\"\n        title=\"react flame chart\"\n        src=\"/static/dea2f1bf42c8d14cec7363bbd8d5fdd9/1e043/react-flame-chart.png\"\n        srcset=\"/static/dea2f1bf42c8d14cec7363bbd8d5fdd9/991de/react-flame-chart.png 173w,\n/static/dea2f1bf42c8d14cec7363bbd8d5fdd9/e4d6b/react-flame-chart.png 345w,\n/static/dea2f1bf42c8d14cec7363bbd8d5fdd9/1e043/react-flame-chart.png 690w,\n/static/dea2f1bf42c8d14cec7363bbd8d5fdd9/ad997/react-flame-chart.png 1012w\"\n        sizes=\"(max-width: 690px) 100vw, 690px\"\n        style=\"width:100%;height:100%;margin:0;vertical-align:middle;position:absolute;top:0;left:0;\"\n        loading=\"lazy\"\n      />\n  </a>\n    </span></p>\n<p>물론 컴포넌트 트리는 이것보다 훨씬 컸다. 맨 끝을 알아볼 수 없을 정도로. 필요없는 트리가 더 컸기에, 리렌더가 일어나는 게 더욱 걱정이 됐다.\n위에서 아래로, <code class=\"language-text\">Provider</code>, <code class=\"language-text\">ConnectedRouter</code>, <code class=\"language-text\">App</code>, <code class=\"language-text\">PersistGate</code>, <code class=\"language-text\">ComponentA</code>, <code class=\"language-text\">ComponentB</code>, .... 이렇게 계속 내려갔다.</p>\n<p>그리고 아직까진 우리가 우리 팀에서  <code class=\"language-text\">shouldComponentUpdate</code>/<code class=\"language-text\">PureComponent</code>/<code class=\"language-text\">memo</code>를 많이 쓰지 않는 것을 발견했다.</p>\n<p>그래서 일단은 얘들을 어떻게든 써 보기로 했다. 아직 내 앞에 뭐가 기다리고 있는 지 모른 채...</p>\n<h2 id=\"깨달은-것-1-부모-컴포넌트는-자식-컴포넌트에-대해-별로-신경쓰지-않는다\" style=\"position:relative;\"><a href=\"#%EA%B9%A8%EB%8B%AC%EC%9D%80-%EA%B2%83-1-%EB%B6%80%EB%AA%A8-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EB%8A%94-%EC%9E%90%EC%8B%9D-%EC%BB%B4%ED%8F%AC%EB%84%8C%ED%8A%B8%EC%97%90-%EB%8C%80%ED%95%B4-%EB%B3%84%EB%A1%9C-%EC%8B%A0%EA%B2%BD%EC%93%B0%EC%A7%80-%EC%95%8A%EB%8A%94%EB%8B%A4\" aria-label=\"깨달은 것 1 부모 컴포넌트는 자식 컴포넌트에 대해 별로 신경쓰지 않는다 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>깨달은 것 1: 부모 컴포넌트는 자식 컴포넌트에 대해 별로 신경쓰지 않는다</h2>\n<p>회사의 웹 앱을 관찰하면서 흥미로운 사실을 발견했다. </p>\n<p>회사의 코드를 들고오긴 좀 그래서 예제를 만들었다:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Child1</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Child1 rendered'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child1\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Child2</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Child2 rendered'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child2\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Parent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Parent rendered'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleMouseEnter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevCount</span> <span class=\"token operator\">=></span> prevCount <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>Child1<span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Child2<span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Parent</code></pre></div>\n<p>이 글을 읽는 당신은 <code class=\"language-text\">Parent</code> 컴포넌트에 <code class=\"language-text\">mouseEnter</code>를 했을 때 <code class=\"language-text\">Child1</code>와 <code class=\"language-text\">Child2</code>가 리렌더를 할 것이라고 생각하는가?</p>\n<p>한 번 보자:</p>\n<p><img src=\"/7679e68e71801b2ad0e28feb4b108473/children-re-render-test.gif\" alt=\"children re-render test\"></p>\n<p>아이고. <strong>리렌더를 한다</strong> 그렇지만 나는 왜 그런진 아직도 알진 못했다... (물론 class 컴포넌트에도 똑같은 일이 벌어진다. 궁금하면 직접 해 보는 게 좋을 것이라는 생각이다)</p>\n<p>자식 컴포넌트들은 변경사항을 일으킬 prop이나 state도 없는데, 리렌더를 했다. 왜?? 도대체 왜?? 리액트 공식 문서를 보자:</p>\n<blockquote>\n<p><code class=\"language-text\">shouldComponentUpdate()</code> is invoked before rendering when new props or state are being received. <em><strong>Defaults to true.</strong></em> </p>\n</blockquote>\n<p>It defaults to true. 아... 그렇구나. 리액트는 이렇게 만들어졌단다.</p>\n<p>그럼 어떻게 더 좋게 만들 수 있을까?</p>\n<h2 id=\"깨달은-것-2-children-prop을-써라\" style=\"position:relative;\"><a href=\"#%EA%B9%A8%EB%8B%AC%EC%9D%80-%EA%B2%83-2-children-prop%EC%9D%84-%EC%8D%A8%EB%9D%BC\" aria-label=\"깨달은 것 2 children prop을 써라 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>깨달은 것 2: <code class=\"language-text\">children</code> prop을 써라</h2>\n<p>이번 예시에 있는 단 한가지 차이점은 <code class=\"language-text\">children</code> prop을 쓴다는 것이다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">(</span>Child1<span class=\"token punctuation\">,</span> Child2 코드는 그대로<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Parent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> children <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Parent rendered'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleMouseEnter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevCount</span> <span class=\"token operator\">=></span> prevCount <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">{</span>children<span class=\"token punctuation\">}</span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token operator\">&lt;</span>Parent<span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>Child1<span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span>Child2<span class=\"token operator\">/</span><span class=\"token operator\">></span><span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>Parent<span class=\"token operator\">></span></code></pre></div>\n<p>결과는?</p>\n<p><img src=\"/7539727ef06cafe36adbef41dc809aa0/children-re-render-test-2.gif\" alt=\"children re-render test 2\"></p>\n<p><strong>아. 자식 컴포넌트가 더 이상 리렌더를 하지 않는다</strong>!\n아직까진 리액트가 왜 이 코드는 리렌더를 하지 않고, 방금의 코드는 리렌더를 하는지 정확하게 이해하지는 못했다. 그렇지만 이렇다는 것만 알고 있어도 충분한 도움이 될 것이라고 생각한다. 왜 그런지 아는 분은 댓글을 달아주시면 정말 감사할 것이다!</p>\n<h2 id=\"깨달은-점-3-reactmemo를-쓰자\" style=\"position:relative;\"><a href=\"#%EA%B9%A8%EB%8B%AC%EC%9D%80-%EC%A0%90-3-reactmemo%EB%A5%BC-%EC%93%B0%EC%9E%90\" aria-label=\"깨달은 점 3 reactmemo를 쓰자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>깨달은 점 3: <code class=\"language-text\">React.memo</code>를 쓰자</h2>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> memo <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> Child1 <span class=\"token operator\">=</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Child1 rendered'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child1\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> Child2 <span class=\"token operator\">=</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Child2 rendered'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child2\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Parent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Parent rendered'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleMouseEnter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevCount</span> <span class=\"token operator\">=></span> prevCount <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>Child1<span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Child2<span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Parent</code></pre></div>\n<p><code class=\"language-text\">memo</code>는 말 그대로 특정한 props를 받는 functional component를 memoize한다. 그리고 props가 만약 똑같다면, 이전에 렌더되었던 똑같은 컴포넌트를 리턴할 것이다.\n결과는 당연히 방금과 똑같다. <code class=\"language-text\">Child1</code>과 <code class=\"language-text\">Child2</code>를 리렌더하지 않는다.</p>\n<p>혹시라도 읽기를 귀찮아 하는 분이 계실 수도 있으니 위에 있는 gif를 똑같이 복붙하겠다:</p>\n<p><img src=\"/7539727ef06cafe36adbef41dc809aa0/children-re-render-test-2.gif\" alt=\"children re-render test 2\"></p>\n<p>그렇다. 근데 만약 nested objects를 props로 받는 상황이라면, <code class=\"language-text\">areEqual</code>을 직접 정의해줘야 한다. 이렇게:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> memo <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> Child1 <span class=\"token operator\">=</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> obj <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Child</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>one<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> rendered</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child1\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">areEqual</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> \n  prevProps<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>one <span class=\"token operator\">===</span> nextProps<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>one <span class=\"token operator\">&amp;&amp;</span> prevProps<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>two <span class=\"token operator\">===</span> nextProps<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>two\n  \n<span class=\"token keyword\">const</span> Child2 <span class=\"token operator\">=</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> obj <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Child</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>two<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> rendered</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child2\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> areEqual<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Parent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Parent rendered'</span><span class=\"token punctuation\">)</span>\n\n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleMouseEnter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevCount</span> <span class=\"token operator\">=></span> prevCount <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n    number<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n      one<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n      two<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  \n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>Child1 obj<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>obj<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Child2 obj<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>obj<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Parent</code></pre></div>\n<p>일단은 그냥 <code class=\"language-text\">===</code>를 통해서 객체의 equality를 체크했다. 실제로 만약에 정말 해야 한다면,  <a href=\"https://github.com/FormidableLabs/react-fast-compare\">아마 deep equality를 체크해주는 <code class=\"language-text\">react-fast-compare</code> 같은 라이브러리를 쓸 것이다 (주의: 절대 빠르진 않다. 복잡한 객체를 빠르게 비교할 수 있는 방법은 없다. 그냥 기다려야 한다).</a></p>\n<p>그래서, 결과는 뭔데?</p>\n<p><img src=\"/536256cddb478bebdb07c64fd0e7904e/children-re-render-test-3.gif\" alt=\"children re-render test 3\"></p>\n<p><code class=\"language-text\">Child1</code>는 <code class=\"language-text\">obj</code> prop 더 이상 동일한 걸 모른다. 왜냐하면 <code class=\"language-text\">memo</code>는 shallow comparison만 하기 때문이다.\n반면에 <code class=\"language-text\">Child2</code>는 알고 있다. <code class=\"language-text\">areEqual</code> 함수가 있으니까. <code class=\"language-text\">Child2</code>는 obj가 똑같다는 걸 잘 알고 있다. 그래서 리렌더를 하지 않는다.</p>\n<h2 id=\"4-purecomponentshouldcomponentupdate를-쓰자\" style=\"position:relative;\"><a href=\"#4-purecomponentshouldcomponentupdate%EB%A5%BC-%EC%93%B0%EC%9E%90\" aria-label=\"4 purecomponentshouldcomponentupdate를 쓰자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4: <code class=\"language-text\">PureComponent</code>/<code class=\"language-text\">shouldComponentUpdate</code>를 쓰자</h2>\n<p>Of course, you might wanna use your class component. So here's a brief explanation on that as well:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> Component<span class=\"token punctuation\">,</span> PureComponent <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Child1</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">PureComponent</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Child</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>one<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> rendered</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      Child1\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Child2</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">shouldComponentUpdate</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">nextProps<span class=\"token punctuation\">,</span> nextState</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>one <span class=\"token operator\">!==</span> nextProps<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>one <span class=\"token operator\">&amp;&amp;</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>two <span class=\"token operator\">!==</span> nextProps<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>two\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Child</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>props<span class=\"token punctuation\">.</span>obj<span class=\"token punctuation\">.</span>number<span class=\"token punctuation\">.</span>two<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> rendered</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      Child2\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n  \n<span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseEnter <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">handleMouseEnter</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      count<span class=\"token operator\">:</span> <span class=\"token number\">0</span>\n    <span class=\"token punctuation\">}</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">handleMouseEnter</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">setState</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevState</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">{</span>count<span class=\"token operator\">:</span> prevState<span class=\"token punctuation\">.</span>count <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Parent rendered'</span><span class=\"token punctuation\">)</span>\n    <span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span>\n      number<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>\n        one<span class=\"token operator\">:</span> <span class=\"token number\">1</span><span class=\"token punctuation\">,</span>\n        two<span class=\"token operator\">:</span> <span class=\"token number\">2</span><span class=\"token punctuation\">,</span>\n      <span class=\"token punctuation\">}</span>\n    <span class=\"token punctuation\">}</span>\n\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n        Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>state<span class=\"token punctuation\">.</span>count<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>Child1 obj<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>obj<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Child2 obj<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>obj<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span>\n  \n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Parent</code></pre></div>\n<p>위의 코드는 함수형 컴포넌트를 클래스 컴포넌트로 똑같이 구현한 것이다. 설명은 이렇다:</p>\n<ol>\n<li><code class=\"language-text\">Child</code>를 위해서 <code class=\"language-text\">PureComponent</code>를 썼지만, 목적을 달성하지 못한다. 왜냐하면 neested object가 prop으로 들어가기 때문이다. 부모 컴포넌트가 리렌더를 할 떄 자식 컴포넌트 자신도 리렌더를 계속 할 것이다. 하지만 object가 prop으로 들어가지 않았으면 리렌더를 막을 수 있었을 것이다.</li>\n<li><code class=\"language-text\">shouldComponentUpdate</code>를 <code class=\"language-text\">Child2</code> 위해 썼다. 그리고 이번엔 된다. <code class=\"language-text\">areEqual</code>과 같이 object를 deeply compare한다. <code class=\"language-text\">state</code>가 있는 경우에는, <code class=\"language-text\">nextState</code>를 사용하여 그것과 비교할 수 있다.</li>\n<li>번외이긴 한데, 클래스 컴포넌트를 쓸 때 boilerplate가 너무 많다. 그래서 나는 보통 함수형 컴포넌트를 개인적으로 좋아한다. </li>\n</ol>\n<p>당연하게도, 결과는 바로 위에 있었던 코드와 같다. 그래서 그냥 gif를 복붙하겠다:</p>\n<p><img src=\"/536256cddb478bebdb07c64fd0e7904e/children-re-render-test-3.gif\" alt=\"children re-render test 3\"></p>\n<h2 id=\"꺠달은-점-5-함수가-prop으로-들어갈-때-신경써주자\" style=\"position:relative;\"><a href=\"#%EA%BA%A0%EB%8B%AC%EC%9D%80-%EC%A0%90-5-%ED%95%A8%EC%88%98%EA%B0%80-prop%EC%9C%BC%EB%A1%9C-%EB%93%A4%EC%96%B4%EA%B0%88-%EB%95%8C-%EC%8B%A0%EA%B2%BD%EC%8D%A8%EC%A3%BC%EC%9E%90\" aria-label=\"꺠달은 점 5 함수가 prop으로 들어갈 때 신경써주자 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>꺠달은 점 5: 함수가 prop으로 들어갈 때 신경써주자</h2>\n<p>사실, 리액트에서는 많은 경우에 prop이 함수로 들어간다. 특히 함수를 리덕스의 <code class=\"language-text\">mapDispatchToProps</code>에 연결한다던지 (클래스 컴포넌트를 쓸 때), 또는 부모 컴포넌트에서 자식 컴포넌트에게 prop으로 함수를 내려줄 때 이런 상황이 생긴다.</p>\n<p>함수를 신경써 주는 게 사실은 기본적인 것처럼 들릴 수도 있지만, 함수가 있는 경우엔 아무도 알지 못했던 쓸데없는 리렌더가 일어날 수 있다.</p>\n<p>때때로 개발할 때 이런 패턴이 나올 때가 있다:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> memo <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> Child1 <span class=\"token operator\">=</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> num<span class=\"token punctuation\">,</span> sayHiInChildren <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Child</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> rendered</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">sayHiInChildren</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Child1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child1\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">areEqual</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> \n  prevProps<span class=\"token punctuation\">.</span>num <span class=\"token operator\">===</span> nextProps<span class=\"token punctuation\">.</span>num <span class=\"token operator\">&amp;&amp;</span> prevProps<span class=\"token punctuation\">.</span>sayHiInChildren <span class=\"token operator\">===</span> nextProps<span class=\"token punctuation\">.</span>sayHiInChildren\n  \n<span class=\"token keyword\">const</span> Child2 <span class=\"token operator\">=</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> num<span class=\"token punctuation\">,</span> sayHiInChildren <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Child</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> rendered</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">sayHiInChildren</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Child2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child2\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> areEqual<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Parent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Parent rendered'</span><span class=\"token punctuation\">)</span>\n  \n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleMouseEnter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevCount</span> <span class=\"token operator\">=></span> prevCount <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sayHiInChildren</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">child</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">hi~~~~~~~~~ - from </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>child<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>Child1 num<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span> sayHiInChildren<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sayHiInChildren<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Child2 num<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span> sayHiInChildren<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sayHiInChildren<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Parent</code></pre></div>\n<p>설명:</p>\n<ol>\n<li><code class=\"language-text\">obj</code> prop은 더 이상 object가 아니다. 그냥 <code class=\"language-text\">num</code>이다. </li>\n<li><code class=\"language-text\">sayHiInChildren</code>이라는 함수를 <code class=\"language-text\">Child2</code>에 <code class=\"language-text\">prop</code>으로 내려준다. </li>\n<li>props가 똑같은지 shallow comparison을 한다. <code class=\"language-text\">Child1</code>와 <code class=\"language-text\">Child2</code>에서 모두. (사실 <code class=\"language-text\">Child1</code> 컴포넌트는 <code class=\"language-text\">areEqual</code> 함수를 쓰지 않고, <code class=\"language-text\">Child2</code>만 쓴다. 그렇지만 어차피 이 문맥에서는 동일한 효과가 있다). </li>\n<li><code class=\"language-text\">Child1</code>와 <code class=\"language-text\">Child2</code>의 props가 절대 변하지 않지만 리렌더는 계속 일어날 것이다.</li>\n</ol>\n<p><img src=\"/e9e0b1f8329d3ad86715c27432bbaa17/children-re-render-test-4.gif\" alt=\"children re-render test 4\"></p>\n<p>근데 진짜 왜..!?</p>\n<p>자바스크립트에서는 함수를 비교할 수 있는 방법이 별로 없다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\">prevProps<span class=\"token punctuation\">.</span>sayHiInChildren <span class=\"token operator\">===</span> nextProps<span class=\"token punctuation\">.</span>sayHiInChildren</code></pre></div>\n<p>위의 코드는 항상 <code class=\"language-text\">false</code>다. 왜냐하면 자바스크립트에서 함수는 object고, object는 value가 아닌 reference로 비교되기 때문이다:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'we are not the same'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">function</span> <span class=\"token function\">b</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'we are not the same'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\na <span class=\"token operator\">===</span> b <span class=\"token comment\">// false</span></code></pre></div>\n<p><code class=\"language-text\">true</code>가 나올 수 있게 하는 단 한 가지 방법은 동일한 reference를 가질 수 있도록 해 주는 것이다:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">function</span> <span class=\"token function\">a</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'we are not the same'</span><span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">const</span> b <span class=\"token operator\">=</span> a\na <span class=\"token operator\">===</span> b <span class=\"token comment\">// true</span></code></pre></div>\n<p>그렇다면 우리가 어떻게 props에 낑겨있는 함수에 대한 문제를 해결할 수 있을까? </p>\n<h3 id=\"1-없애버리기\" style=\"position:relative;\"><a href=\"#1-%EC%97%86%EC%95%A0%EB%B2%84%EB%A6%AC%EA%B8%B0\" aria-label=\"1 없애버리기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>1. 없애버리기</h3>\n<p><code class=\"language-text\">util.ts</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> _ <span class=\"token keyword\">from</span> <span class=\"token string\">'lodash-es'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> isEqual <span class=\"token keyword\">from</span> <span class=\"token string\">'react-fast-compare'</span><span class=\"token punctuation\">;</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">removeFunctions</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">fromObj</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> obj <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">}</span>\n  <span class=\"token comment\">/**\n   * @description nested object properties에 속해있지 않은 함수들만 없앤다. \n   * 당연히 recursion을 사용해서 함수를 없앨 수 있다 ^^. 단지 구현하지 않았다.\n   */</span> \n  Object<span class=\"token punctuation\">.</span><span class=\"token function\">keys</span><span class=\"token punctuation\">(</span>fromObj<span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span><span class=\"token function\">forEach</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">key</span> <span class=\"token operator\">=></span> <span class=\"token operator\">!</span>_<span class=\"token punctuation\">.</span><span class=\"token function\">isFunction</span><span class=\"token punctuation\">(</span>fromObj<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">&amp;&amp;</span> <span class=\"token punctuation\">(</span>obj<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> fromObj<span class=\"token punctuation\">[</span>key<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> obj\n<span class=\"token punctuation\">}</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">areEqual</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>prev<span class=\"token punctuation\">,</span> next<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>prevProps<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>removeFunctions<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">isEqual</span><span class=\"token punctuation\">(</span>prev<span class=\"token punctuation\">,</span> next<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>lodash의 <code class=\"language-text\">_.isFunction</code>을 사용해서 객체의 프로퍼티가 함수인지 확인할 수 있다.\n<code class=\"language-text\">removeFunctions</code>를 적용하면 함수가 아닌 프로퍼티들만 남게 된다. 그러면 그 props를 <code class=\"language-text\">areEqual</code>에 넣으면 된다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> React<span class=\"token punctuation\">,</span> <span class=\"token punctuation\">{</span> useState<span class=\"token punctuation\">,</span> memo <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'react'</span><span class=\"token punctuation\">;</span>\n<span class=\"token keyword\">import</span> <span class=\"token punctuation\">{</span> areEqual <span class=\"token punctuation\">}</span> <span class=\"token keyword\">from</span> <span class=\"token string\">'./util'</span>\n\n<span class=\"token keyword\">const</span> Child1 <span class=\"token operator\">=</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> num<span class=\"token punctuation\">,</span> sayHiInChildren <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Child</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> rendered</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">sayHiInChildren</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Child1'</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child1\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> areEqual<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> Child2 <span class=\"token operator\">=</span> <span class=\"token function\">memo</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token punctuation\">{</span> num<span class=\"token punctuation\">,</span> sayHiInChildren <span class=\"token punctuation\">}</span></span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">Child</span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>num<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token string\"> rendered</span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span>\n  <span class=\"token function\">sayHiInChildren</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Child2'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid red'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'30px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Child2\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span><span class=\"token punctuation\">,</span> areEqual<span class=\"token punctuation\">)</span>\n\n<span class=\"token keyword\">const</span> <span class=\"token function-variable function\">Parent</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token string\">'Parent rendered'</span><span class=\"token punctuation\">)</span>\n  \n  <span class=\"token keyword\">let</span> <span class=\"token punctuation\">[</span>count<span class=\"token punctuation\">,</span> setCount<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token function\">useState</span><span class=\"token punctuation\">(</span><span class=\"token number\">0</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">handleMouseEnter</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token function\">setCount</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">prevCount</span> <span class=\"token operator\">=></span> prevCount <span class=\"token operator\">+</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">sayHiInChildren</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">child</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">hi~~~~~~~~~ - from </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>child<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  \n  <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n    Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span>\n    <span class=\"token operator\">&lt;</span>Child1 num<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span> sayHiInChildren<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sayHiInChildren<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span>Child2 num<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span> sayHiInChildren<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sayHiInChildren<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n  <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n<span class=\"token punctuation\">}</span>\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">default</span> Parent</code></pre></div>\n<p>결과는? 부모 컴포넌트만 리렌더하게 된다. 함수가 아닌 props만 비교하기 때문에 가능한 일이다.</p>\n<p><img src=\"/79833449b2fdc4cfe140e26c73eb8969/children-re-render-test-5.gif\" alt=\"children re-render test 5\"></p>\n<p>사실 이 방법은 별로 추천하진 않는다. 왜냐하면 그냥 뭔가 올바른 방법이 아니란 건 확실하기 때문이다. 무언가를 더하지 않고 없애는 거니까. 어차피 밑에 더 좋은 방법들을 소개하니까 걱정하지 마시라.</p>\n<h3 id=\"2-stringify-하기\" style=\"position:relative;\"><a href=\"#2-stringify-%ED%95%98%EA%B8%B0\" aria-label=\"2 stringify 하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>2. <code class=\"language-text\">stringify</code> 하기</h3>\n<p>default로는 <code class=\"language-text\">JSON.stringify</code>는 함수를 stringify하는 것을 지원하지 않는다.그래서 <a href=\"https://github.com/vkiryukhin/jsonfn#readme\">jsonfn</a>와 같은 3rd party 라이브러리를 사용해야 한다.</p>\n<p><code class=\"language-text\">util.js</code></p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">import</span> JSONfn <span class=\"token keyword\">from</span> <span class=\"token string\">'json-fn'</span>\n<span class=\"token keyword\">import</span> isEqual <span class=\"token keyword\">from</span> <span class=\"token string\">'react-fast-compare'</span>\n\n<span class=\"token keyword\">export</span> <span class=\"token keyword\">const</span> <span class=\"token function-variable function\">areEqual</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token parameter\">prevProps<span class=\"token punctuation\">,</span> nextProps</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">=></span> <span class=\"token punctuation\">{</span>\n  <span class=\"token keyword\">const</span> <span class=\"token punctuation\">[</span>prev<span class=\"token punctuation\">,</span> next<span class=\"token punctuation\">]</span> <span class=\"token operator\">=</span> <span class=\"token punctuation\">[</span>prevProps<span class=\"token punctuation\">,</span> nextProps<span class=\"token punctuation\">]</span><span class=\"token punctuation\">.</span><span class=\"token function\">map</span><span class=\"token punctuation\">(</span>JSONfn<span class=\"token punctuation\">.</span>stringify<span class=\"token punctuation\">)</span>\n  <span class=\"token keyword\">return</span> <span class=\"token function\">isEqual</span><span class=\"token punctuation\">(</span>prev<span class=\"token punctuation\">,</span> next<span class=\"token punctuation\">)</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p><code class=\"language-text\">JSONfn.stringify</code>는 이렇게 보이는 string을 만들어줄 것이다:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token punctuation\">{</span><span class=\"token string\">\"num\"</span><span class=\"token operator\">:</span><span class=\"token number\">1</span><span class=\"token punctuation\">,</span><span class=\"token string\">\"sayHiInChildren\"</span><span class=\"token operator\">:</span><span class=\"token string\">\"_NuFrRa_child => console.log(\\\"hi~~~~~~~~~ - from \\\".concat(child))\"</span><span class=\"token punctuation\">}</span></code></pre></div>\n<p>이 함수를 쓰면 이전의 예시와 동일한 결과를 가져다 줄 것이다. 복붙 한번만 더 하겠다:</p>\n<p><img src=\"/79833449b2fdc4cfe140e26c73eb8969/children-re-render-test-5.gif\" alt=\"children re-render test 5\"></p>\n<p>이 방법의 단점은 당연히, 느리다.</p>\n<p>그냥, 느리다. object가 크면 클 수록 느리다. 지양하자.</p>\n<h3 id=\"3-usecallback-사용하기\" style=\"position:relative;\"><a href=\"#3-usecallback-%EC%82%AC%EC%9A%A9%ED%95%98%EA%B8%B0\" aria-label=\"3 usecallback 사용하기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>3. <code class=\"language-text\">useCallback</code> 사용하기</h3>\n<p>만약 리렌더를 방지하고 싶다면, 이것이 Functional component에서 사용할 때 가장 현명한 방법이라고 생각한다.</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">const</span> sayHiInChildren <span class=\"token operator\">=</span> <span class=\"token function\">useCallback</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">child</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">hi~~~~~~~~~ — from </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>child<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">,</span> <span class=\"token punctuation\">[</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span></code></pre></div>\n<p>useCallback은 dependency array를 참고해서 아무것도 바뀌지 않았을 시 memoized된 callback을 반환한다 (위의 예시에서는 비어있는 배열이라서 항상 동일한 callback을 반환한다).</p>\n<p>이렇게만 해주면 prop으로 들어가는 함수로 인한 리렌더를 방지할 수 있다.</p>\n<h3 id=\"4-함수를-클래스에-bind-해-주기\" style=\"position:relative;\"><a href=\"#4-%ED%95%A8%EC%88%98%EB%A5%BC-%ED%81%B4%EB%9E%98%EC%8A%A4%EC%97%90-bind-%ED%95%B4-%EC%A3%BC%EA%B8%B0\" aria-label=\"4 함수를 클래스에 bind 해 주기 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>4. 함수를 클래스에 bind 해 주기</h3>\n<p><code class=\"language-text\">useCallback</code>은 모두 알다시피 함수형 컴포넌트에서밖에 쓰지 못한다. 클래스 컴포넌트에서는 이 문제를 어떻게 해결해야 할까?</p>\n<p>사실 이미 하고 있었을 수도 있다. 이렇게 하면 된다:</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function-variable function\">sayHiInChildren</span> <span class=\"token operator\">=</span> <span class=\"token parameter\">child</span> <span class=\"token operator\">=></span> console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">hi~~~~~~~~~ - from </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>child<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>Child1 num<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span> sayHiInChildren<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sayHiInChildren<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Child2 num<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span> sayHiInChildren<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sayHiInChildren<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게 해 주거나,</p>\n<div class=\"gatsby-highlight\" data-language=\"js\"><pre class=\"language-js\"><code class=\"language-js\"><span class=\"token keyword\">class</span> <span class=\"token class-name\">Parent</span> <span class=\"token keyword\">extends</span> <span class=\"token class-name\">React<span class=\"token punctuation\">.</span>Component</span> <span class=\"token punctuation\">{</span>\n  <span class=\"token function\">constructor</span><span class=\"token punctuation\">(</span><span class=\"token parameter\"><span class=\"token operator\">...</span>args</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">super</span><span class=\"token punctuation\">(</span><span class=\"token operator\">...</span>args<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span>sayHiInChildren <span class=\"token operator\">=</span> <span class=\"token keyword\">this</span><span class=\"token punctuation\">.</span><span class=\"token function\">sayHiInChildren</span><span class=\"token punctuation\">.</span><span class=\"token function\">bind</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">this</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">sayHiInChildren</span><span class=\"token punctuation\">(</span><span class=\"token parameter\">child</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">{</span>\n    console<span class=\"token punctuation\">.</span><span class=\"token function\">log</span><span class=\"token punctuation\">(</span><span class=\"token template-string\"><span class=\"token template-punctuation string\">`</span><span class=\"token string\">hi~~~~~~~~~ - from </span><span class=\"token interpolation\"><span class=\"token interpolation-punctuation punctuation\">${</span>child<span class=\"token interpolation-punctuation punctuation\">}</span></span><span class=\"token template-punctuation string\">`</span></span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n  <span class=\"token punctuation\">}</span>\n\n  <span class=\"token function\">render</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">&lt;</span>div onMouseEnter<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>handleMouseEnter<span class=\"token punctuation\">}</span> style <span class=\"token operator\">=</span> <span class=\"token punctuation\">{</span><span class=\"token punctuation\">{</span>border<span class=\"token operator\">:</span> <span class=\"token string\">'1px solid black'</span><span class=\"token punctuation\">,</span> padding<span class=\"token operator\">:</span> <span class=\"token string\">'50px'</span><span class=\"token punctuation\">}</span><span class=\"token punctuation\">}</span><span class=\"token operator\">></span>\n      Parent<span class=\"token punctuation\">.</span> Count<span class=\"token operator\">:</span> <span class=\"token punctuation\">{</span>count<span class=\"token punctuation\">}</span>\n      <span class=\"token operator\">&lt;</span>Child1 num<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">1</span><span class=\"token punctuation\">}</span> sayHiInChildren<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sayHiInChildren<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n      <span class=\"token operator\">&lt;</span>Child2 num<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span><span class=\"token number\">2</span><span class=\"token punctuation\">}</span> sayHiInChildren<span class=\"token operator\">=</span><span class=\"token punctuation\">{</span>sayHiInChildren<span class=\"token punctuation\">}</span><span class=\"token operator\">/</span><span class=\"token operator\">></span>\n    <span class=\"token operator\">&lt;</span><span class=\"token operator\">/</span>div<span class=\"token operator\">></span>\n  <span class=\"token punctuation\">}</span>\n<span class=\"token punctuation\">}</span></code></pre></div>\n<p>이렇게만 해주면 함수를 향한 consistent reference를 유지할 수 있어서 리렌더를 방지할 수 있다.</p>\n<h2 id=\"끝내기-전에-꼭-말하고-싶은-것\" style=\"position:relative;\"><a href=\"#%EB%81%9D%EB%82%B4%EA%B8%B0-%EC%A0%84%EC%97%90-%EA%BC%AD-%EB%A7%90%ED%95%98%EA%B3%A0-%EC%8B%B6%EC%9D%80-%EA%B2%83\" aria-label=\"끝내기 전에 꼭 말하고 싶은 것 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>끝내기 전에 꼭 말하고 싶은 것</h2>\n<p>일단 밑에 더 읽기 귀찮으면 이 말만 읽으면 좋을 것 같다: <strong>항상 리렌더를 방지하는 게 가장 효율적인 아웃풋을 가져오는 것은 아니다.</strong> 예를 들어 회사에서 <code class=\"language-text\">complexObject</code>라는 props을 자식 컴포넌트로 넘긴다고 치자. 이 객체는 500개가 넘는 키와 nested properties까지 가지고 있다. 그러면 아마도, 내가 이 글에서 제안한 방법보다는 그냥 맘 편하게 리렌더를 하는 게 더 좋을 것이다. 왜냐하면 리렌더를 하는 시간이 prop을 비교하는 시간보다 빠를 수도 있기 때문이다 (그리고 아마 그럴 것이다). 이건 꼭 기억해야 한다. 만약에 생각없이 memo나 deepEqual같은 함수들을 쓰고 있다면 다시 한 번 생각해보자. <strong>다시 한 번 말하지만, 항상 optimize 를 하려고 하는 것이 좋은 것만은 아니다.</strong></p>\n<p>사실 요즘 들어 더 느끼는 건 React가 참 느리다는 것이다. </p>\n<p>Dan Abramov가 처음에 virtual DOM과 reconciliation이라는 걸 생각해내서 뭔가 더 efficient한 느낌을 줬지만, 시간이 지나면서 그게 느리다는게 탄로(?)나고 말았다. 리액트의 ecosystem이 엄청나게 커서 리액트가 멸망? 하는 데에는 시간이 좀 걸리겠지만.. reconciliation을 버리지 않는 이상 리액트는 이대로 느린 상태가 될 것이고, 결국 svelte같은 프레임워크에 뒤처질 거란 생각이다 (근데 그게 언제가 될 진 모르겠다). 하여튼 virtual DOM은 실수였다고 생각한다. 그냥 svelte처럼 자연스러운 javascript와 html을 존중하며 따라가는게 맞았다. 그게 성능을 보존할 수 있는 방법이다.</p>\n<h2 id=\"요약\" style=\"position:relative;\"><a href=\"#%EC%9A%94%EC%95%BD\" aria-label=\"요약 permalink\" class=\"anchor before\"><svg aria-hidden=\"true\" focusable=\"false\" height=\"16\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"16\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a>요약</h2>\n<ul>\n<li><code class=\"language-text\">children</code> prop을 사용하지 않으면, <code class=\"language-text\">render</code> 함수 안에 있는 모든 컴포넌트는 기본적으로 리렌더를 할 것이다.</li>\n<li>\n<p>리렌더를 방지하기 위한 방법은 크게 두 가지가 있다:</p>\n<ul>\n<li><code class=\"language-text\">memo</code>와 <code class=\"language-text\">areEqual</code> 쓰기 (함수형 컴포넌트),</li>\n<li><code class=\"language-text\">PureComponent</code>와 <code class=\"language-text\">shouldComponentUpdate</code> 쓰기 (클래스 컴포넌트)</li>\n</ul>\n</li>\n<li>If there are functions in your props, before using <code class=\"language-text\">areEqual</code> or <code class=\"language-text\">shouldComponentUpdate</code>:</li>\n<li>\n<p>props에 함수가 포함되어 있다면, <code class=\"language-text\">areEqual</code>이나 <code class=\"language-text\">shouldComponentUpdate</code>를 쓰기 전에:</p>\n<ul>\n<li>아예 없애버리자 (비추).</li>\n<li><code class=\"language-text\">stringify</code>하자 (비추).</li>\n<li><code class=\"language-text\">useCallback</code>을 쓰자.</li>\n<li>함수를 <code class=\"language-text\">bind</code>해서 쓰자.</li>\n</ul>\n</li>\n</ul>","timeToRead":14,"excerpt":"…","frontmatter":{"title":"멍청한 리액트 똑똑하게 만들기","cover":"","date":"2020-02-23","category":"frontend","tags":["react","performance","optimization"],"author":"Hyeokjoo"},"fields":{"slug":"/멍청한-리액트-똑똑하게-만들기","date":"2020-02-22T15:00:00.000Z"}}},"pageContext":{"slug":"/멍청한-리액트-똑똑하게-만들기","nexttitle":"redux-observable 테스트 및 사용 방법","nextslug":"/redux-observable-테스트-및-사용-방법","prevtitle":"redux-observable 테스트 및 사용 방법","prevslug":"/redux-observable-테스트-및-사용-방법"}}}